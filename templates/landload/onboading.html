{% extends 'landload/basic.html' %} 
{% load static %}

    {% block style %}
  <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/forms/wizard/bs-stepper.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/forms/select/select2.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/forms/select/select2.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/pickers/flatpickr/flatpickr.min.css' %}">
    <!-- END: Vendor CSS-->
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/plugins/forms/pickers/form-flat-pickr.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/plugins/forms/form-validation.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/pages/app-user.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/core/menu/menu-types/vertical-menu.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/plugins/forms/form-validation.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/plugins/forms/form-wizard.min.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/pages/page-pricing.css' %}">
    <style>
       .select2-container--default .select2-selection--single .select2-selection__rendered {
    color: #ffffff !important;
}
    </style>
       <style>
    .custom-card-dark {
        background-color: #1e1e2f !important; /* Dark purple/navy tone */
        color: #f0f0f5; /* Light gray text */
        border-radius: 10px;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.5);
    }

    .custom-card-dark h3 {
        color: #ffffff;
    }

    .custom-card-dark .plan-price sup,
    .custom-card-dark .plan-price span {
        color: #00d084; /* Custom green */
    }

    .custom-card-dark .pricing-duration {
        color: #bbbccf;
    }

    .custom-card-dark .list-group-item {
        background-color: #1e1e2f !important;
        color: #d4d4e2;
        border: none;
    }

    .custom-card-dark button {
        border: 1px solid #00d084;
        color: #00d084;
    }
    .plan-card {
        position: relative;
        cursor: pointer;
        transition: 0.3s ease-in-out;
        border: 2px solid transparent;
    }

    .plan-card:hover,
    .plan-card input[type="radio"]:checked ~ .card {
        border-color: #00d084 !important;
        box-shadow: 0 0 15px rgba(0, 208, 132, 0.5);
    }

    .plan-radio {
        position: absolute;
        top: 15px;
        left: 15px;
        transform: scale(1.3);
        z-index: 2;
    }

    {% comment %} .custom-card-dark button:hover {
        background-color: #00d084;
        color: #1e1e2f;
    } {% endcomment %}
</style>
    {% endblock style %}

{% block content %}


        <div class="content-overlay"></div>
        <div class="header-navbar-shadow"></div>
        <div class="content-wrapper container-xxl p-0">
            <div class="content-header row">
              <div class="content-header-left col-md-9 col-12 mb-2">
                  <div class="row breadcrumbs-top">
                      <div class="col-12">
                          <a href="{% url 'landload:home' %}"><h2 class="content-header-title float-start mb-0">Home</h2></a>
                          <div class="breadcrumb-wrapper">
                              <ol class="breadcrumb">
                                  <li class="breadcrumb-item">
                                      Onboarding
                                  </li>
                                  
                              </ol>
                          </div>
                      </div>
                  </div>
              </div>
            <div class="content-body">
                
                <section class="horizontal-wizard">
                  <div class="bs-stepper horizontal-wizard-example">
                    <div class="bs-stepper-header d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center  gap-0">
                       <div class="d-flex flex-wrap flex-md-nowrap align-items-start align-items-md-center gap-0">
                          <!-- Step 1 -->
                          <div class="step" data-target="#account-details">
                            <button type="button" class="step-trigger">
                              <span class="bs-stepper-box">1</span>
                              <span class="bs-stepper-label">
                                <span class="bs-stepper-title">Step 1</span>
                                <span class="bs-stepper-subtitle">Regional Details </span>
                              </span>
                            </button>
                          </div>
                          <div class="line d-none d-md-block">
                            <i data-feather="chevron-right" class="font-medium-2"></i>
                          </div>

                          <div class="step" data-target="#personal-info">
                            <button type="button" class="step-trigger">
                              <span class="bs-stepper-box">2</span>
                              <span class="bs-stepper-label">
                                <span class="bs-stepper-title">Step 2</span>
                                <span class="bs-stepper-subtitle">Profile Details</span>
                              </span>
                            </button>
                          </div>
                          <div class="line d-none d-md-block">
                            <i data-feather="chevron-right" class="font-medium-2"></i>
                          </div>

                          <div class="step" data-target="#bank-account">
                            <button type="button" class="step-trigger">
                              <span class="bs-stepper-box">3</span>
                              <span class="bs-stepper-label">
                                <span class="bs-stepper-title">step 3</span>
                                <span class="bs-stepper-subtitle">Document Upload </span>
                              </span>
                            </button>
                          </div>
                          <div class="line d-none d-md-block">
                            <i data-feather="chevron-right" class="font-medium-2"></i>
                          </div>

                          <div class="step" data-target="#upload-document">
                            <button type="button" class="step-trigger">
                              <span class="bs-stepper-box">4</span>
                              <span class="bs-stepper-label">
                                <span class="bs-stepper-title">Step 4</span>
                                <span class="bs-stepper-subtitle">Select Plan type</span>
                              </span>
                            </button>
                          </div>
                          <div class="line d-none d-md-block">
                            <i data-feather="chevron-right" class="font-medium-2"></i>
                          </div>

                          <!-- Step 3 -->
                          <div class="step" data-target="#review-offer">
                            <button type="button" class="step-trigger">
                              <span class="bs-stepper-box">5</span>
                              <span class="bs-stepper-label">
                                <span class="bs-stepper-title">Step 5</span>
                                <span class="bs-stepper-subtitle">Verify Payment</span>
                              </span>
                            </button>
                          </div>
                          <div class="line d-none d-md-block">
                            <i data-feather="chevron-right" class="font-medium-2"></i>
                          </div>
                          <div class="step" data-target="#step-6">
                            <button type="button" class="step-trigger">
                              <span class="bs-stepper-box">6</span>
                              <span class="bs-stepper-label">
                                <span class="bs-stepper-title">Step 6</span>
                                <span class="bs-stepper-subtitle">Final Review</span>
                              </span>
                            </button>
                          </div>
                        </div>
                        
                        

                        <!-- Save / Edit Buttons -->
                        {% if more_fun %}
                        <div class="d-flex flex-wrap gap-2">
                          <a href="{% url 'landload:listing_update' id=property_id %}">
                            <button class="btn btn-primary waves-effect waves-float waves-light">Edit</button>
                          </a>
                          {% comment %} {% if property_obj.number_of_flat %}
                          <a href="{% url 'landload:room' id=property_id %}">
                            <button class="btn btn-primary waves-effect waves-float waves-light">Room</button>
                          </a>
                          {% endif %} {% endcomment %}
                        </div>
                        {% endif %}
                      </div>
                    
    <div class="bs-stepper-content">
      <div id="account-details" class="content">
        <div class="content-header">
        </div>
        <form method="POST" id="form-step-1"  class="invoice-repeater">
            {% comment %} <div class="row mb-2">
                <div class="col-12">
                <label class="form-label" for="rental-type">Rental Type</label>
                <div class="d-flex flex-wrap gap-2">
                  {% for radio in form.rental_type %}
                    <div class="form-check form-check-inline">
                      {{ radio.tag }} {{ radio.choice_label }}
                    </div>
                  {% endfor %}
                </div>
              </div>
              </div> {% endcomment %}
              <div class="row mb-2">
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="first_name">Country</label>
                        {{form1.country}}
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="first_name">Currency</label>
                        {{form1.currency}}
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="first_name">time_zone</label>
                        {{form1.time_zone}}
                    </div>
                </div>
            </div>
             <div class="row mb-2">
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="first_name">User Data Hosting Location</label>
                        {{form1.user_data_hosting_location}}
                    </div>
                </div>
            </div>
            
           
        </form>
        <div class="d-flex justify-content-between mt-1">
          <button class="btn btn-outline-secondary btn-prev" disabled>
            <i data-feather="arrow-left" class="align-middle mr-sm-25 mr-0"></i>
            <span class="align-middle d-sm-inline-block d-none">Previous</span>
          </button>
          <button class="btn btn-primary btn-next" onclick="submitForm(1)">
            <span class="align-middle d-sm-inline-block d-none">Next</span>
            <i data-feather="arrow-right" class="align-middle ml-sm-25 ml-0"></i>
          </button>
        </div>
      </div>
      <div id="personal-info" class="content">
        
        <form method="POST" id="form-step-2" class='invoice-repeater'>
          {% csrf_token %}
          <input type="hidden" name="formid" {% if property_obj %}value="{{property_obj.id}}"{% endif %}value="">  
          <div class="row mb-2">
                <div class="col-md-3">
                    <div class="form-group">
                        <label for="first_name">First Name</label>
                        <input type="text" name="first_name" id="first_name" class="form-control" value="{{profile_data.first_name}}" {% if more_fun %} readonly disable {% endif %} required>  
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label for="middle_name">Middle Name</label>
                        <input type="text" name="middle_name" id="middle_name"  {% if profile_data.middle_name %}value="{{profile_data.middle_name}}" {% endif %} {% if more_fun %} readonly disable {% endif %} class="form-control" >

                        
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label for="last_name">Last name</label>
                        <input type="text" name="last_name" id="last_name" value="{{profile_data.last_name}}" {% if more_fun %} readonly disable {% endif %} class="form-control" >
                        
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label for="phone_number">Phone Number</label>
                        <input type="text" name="phone_number" pattern="\d{10}" maxlength="10"
                                    oninput="this.value = this.value.replace(/[^0-9]/g, '')" id="last_name" class="form-control" value="{{profile_data.phone_number}}" {% if more_fun %} readonly disable {% endif %} required>
                        
                    </div>
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-md-3">
                  <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" name="email" id="email" class="form-control" value="{{profile_data.email}}" readonly disable required>
                  </div>
                </div>
                <div class="form-group col-md-3">
                  <label for="residence_status">Home Address</label>
                    <input type="text" name="address" id="address" class="form-control" {% if profile_data.address %}value="{{profile_data.address}}"{% endif %} {% if more_fun %} readonly disable {% endif %} required>
                </div>
                
                  <div class="form-group col-md-3 visa-details">
                    <label for="visa_type">Billing Address </label>
                    <input type="text" name="billing_address" id="billing_address" class="form-control" {% if data.billing_address %}value="{{data.billing_address}}"{% endif %} {% if more_fun %} readonly disable {% endif %} required>

                  </div>
              </div>
          
          {% comment %} <div id="repeater-section" style="display:{% if property_obj2.other %}block{% else %} none{% endif %};">
            <div data-repeater-list="invoice">
              {% if property_obj2.other %}
              {% for i in property_obj2.financialsother.all %}
              <div data-repeater-item>
                <div class="row d-flex align-items-end">
                  <div class="col-md-4 col-12">
                    <div class="form-group">
                      <label for="itemname">Label</label>
                      <input
                        type="text"
                        class="form-control"
                        name="label"
                        id="itemname"
                        aria-describedby="itemname"
                        placeholder="Enter your field"
                        value="{{i.lable}}"
                        {% if more_fun %} readonly {% endif %}
                      />
                    </div>
                  </div>

                  <div class="col-md-2 col-12">
                    <div class="form-group">
                      <label for="itemcost">Amount</label>
                      <input
                        type="number"
                        class="form-control"
                        name='amount'
                        id="itemcost"
                        aria-describedby="itemcost"
                        placeholder="32"
                        value='{{i.amount}}'
                        {% if more_fun %} readonly {% endif %}
                      />
                    </div>
                  </div>

                  <div class="col-md-2 col-12 mb-50">
                    <div class="form-group">
                      <button class="btn btn-outline-danger text-nowrap px-1" data-repeater-delete type="button"{% if more_fun %} disabled {% endif %}>
                        <i data-feather="x" class="mr-25"></i>
                        <span>Delete</span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
                {% endfor %}
                {% else %}
                <div data-repeater-item>
                <div class="row d-flex align-items-end">
                  <div class="col-md-4 col-12">
                    <div class="form-group">
                      <label for="itemname">Label</label>
                      <input
                        type="text"
                        class="form-control"
                        name="label"
                        id="itemname"
                        aria-describedby="itemname"
                        placeholder="Enter your field"
                        {% if more_fun %} readonly {% endif %}
                      />
                    </div>
                  </div>

                  <div class="col-md-2 col-12">
                    <div class="form-group">
                      <label for="itemcost">Amount</label>
                      <input
                        type="number"
                        class="form-control"
                        name='amount'
                        id="itemcost"
                        aria-describedby="itemcost"
                        placeholder="32"
                        {% if more_fun %} readonly {% endif %}
                      />
                    </div>
                  </div>

                  <div class="col-md-2 col-12 mb-50">
                    <div class="form-group">
                      <button class="btn btn-outline-danger text-nowrap px-1" data-repeater-delete type="button" {% if more_fun %} disabled {% endif %}>
                        <i data-feather="x" class="mr-25"></i>
                        <span>Delete</span>
                      </button>
                    </div>
                  </div>
                </div>
                <hr />
              </div>
              {% endif %}
            </div>
            <div class="row mb-2 mt-2">
              <div class="col-12">
                <button class="btn btn-icon btn-primary" type="button" data-repeater-create {% if more_fun %} disabled {% endif %}>
                  <i data-feather="plus" class="mr-25"></i>
                  <span>Add New</span>
                </button>
              </div>
            </div>
          </div> {% endcomment %}
         
        </form>
        <div class="d-flex justify-content-between">
          <button class="btn btn-primary btn-prev" onclick="stepper.previous()">
            <i data-feather="arrow-left" class="align-middle mr-sm-25 mr-0"></i>
            <span class="align-middle d-sm-inline-block d-none">Previous</span>
          </button>
          <button class="btn btn-primary btn-next" onclick="submitForm(2)">
            <span class="align-middle d-sm-inline-block d-none">Next</span>
            <i data-feather="arrow-right" class="align-middle ml-sm-25 ml-0"></i>
          </button>
        </div>
      </div>
      {{ docland_image_urls|json_script:"docland-images-json" }}
      <script>
        const garageImages = JSON.parse(document.getElementById('docland-images-json').textContent);
      </script>
      <div id="bank-account" class="content">
        <form method="post" id="form-step-3" enctype="multipart/form-data">
          {% csrf_token %}
            <div class="row mb-2 align-items-center">
              <div class="col-12 col-sm-4 col-md-1 mb-sm-0">
                <h4 class="m-0">ID Proff</h4>
                
                                              
                                              
                                          
                {% comment %} <label class="form-label" for="first-name">Outside</label> {% endcomment %}
                {% comment %} {{form3.outside}} {% endcomment %}
              </div>  
              {% if doclandload %}
             <div class="col-md-2 col-sm-12">
              <div class="card">
                <div class="card-body">
                  <div id="{{ idproffform.garage.id_for_label }}Carousel" class="carousel slide" data-bs-ride="carousel">
                    <!-- Indicators -->
                    <div class="carousel-indicators">
                      {% for image in doclandload %}
                      <button type="button"
                            data-bs-target="{{ idproffform.id_for_label }}"
                            data-bs-slide-to="{{ forloop.counter0 }}"
                            id="item{{image.id}}"
                            class="{% if forloop.first %}active{% endif %}"
                            aria-current="{% if forloop.first %}true{% endif %}"
                            aria-label="Slide {{ forloop.counter }}"></button>
                      {% endfor %}
                        </div>

                    <!-- Slides -->
                    <div class="carousel-inner">
                      {% for image in doclandload %}
                      <div class="carousel-item {% if forloop.first %}active{% endif %}" id='carousel-item{{ image.id }}' data-image-id="{{ image.id }}">
                        
                          <img src="{{ image.upload_document.url }}" class="d-block w-100 img-fluid rounded"
                          style="cursor: pointer;"
                            onclick="showCarouselModal(garageImages, {{ forloop.counter0 }},'{{ idproffform.id_for_label }}Carousel')">
                        <div class="carousel-caption d-none d-md-block">
                          
                        </div>
                      </div>
                       {% endfor %}
                    </div>

                    <!-- Controls -->
                    <button class="carousel-control-prev" type="button" data-bs-target="#{{ idproffform.id_for_label }}Carousel" data-bs-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#{{ idproffform.id_for_label }}Carousel" data-bs-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Next</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            {% endif %}
            <div class="col-12 col-sm-4 col-md-2 text-center text-sm-start">
                <div class="d-flex flex-column flex-sm-row align-items-center justify-content-center justify-content-sm-start gap-2">
                  <label for="{{ idproffform.id_proff.id_for_label }}" class="btn btn-primary btn-sm mb-0">+</label>
                  {{idproffform.id_proff}}
                  {% comment %} <input type="file" name="garage" {% if more_fun %} disabled {% endif %} id="account-upload" hidden accept="image/*" /> {% endcomment %}
                  <p class="mb-0 small text-muted">Allowed file types: png, jpg, jpeg.</p>
                </div>
            </div>
          </div>
    
          
        </form >
        <div class="d-flex justify-content-between">
          <button class="btn btn-primary btn-prev" onclick="stepper.previous()">
            <i data-feather="arrow-left" class="align-middle mr-sm-25 mr-0"></i>
            <span class="align-middle d-sm-inline-block d-none">Previous</span>
          </button>
          <button class="btn btn-primary btn-next" onclick="submitForm(3)">
            <span class="align-middle d-sm-inline-block d-none">Next</span>
            <i data-feather="arrow-right" class="align-middle ml-sm-25 ml-0"></i>
          </button>
        </div>
      </div>
   

  
       <div id="upload-document" class="content">
        
        <form method="post" id="form-step-4" class="invoice-repeater" enctype="multipart/form-data">
          {% csrf_token %}
    
         
         <div class="row pricing-card">
                        <div class="col-12 col-sm-offset-2 col-sm-10 col-md-12 col-lg-offset-2 col-lg-10 mx-auto">
                            <div class="row">
                                <!-- basic plan -->
                                <div class="col-12 col-md-4">
                                  <div class="card basic-pricing text-center custom-card-dark">
                                    <input required type="radio" name="selected_plan" value="basic" class="plan-radio" {% if data.subscription == 'basic' %}checked {% endif %} />
                                      <div class="card-body">
                                          <h3>Basic</h3>
                                          <p class="card-text">A simple start for everyone</p>
                                          <div class="annual-plan">
                                              <div class="plan-price mt-2">
                                                  <sup class="font-medium-1 font-weight-bold">$</sup>
                                                  <span class="pricing-basic-value font-weight-bolder">0</span>
                                                  <sub class="pricing-duration font-medium-1 font-weight-bold">/month</sub>
                                              </div>
                                              <small class="annual-pricing d-none text-muted"></small>
                                          </div>
                                          <ul class="list-group list-group-circle text-left">
                                              <li class="list-group-item">100 responses a month</li>
                                              <li class="list-group-item">Unlimited forms and surveys</li>
                                              <li class="list-group-item">Unlimited fields</li>
                                              <li class="list-group-item">Basic form creation tools</li>
                                              <li class="list-group-item">Up to 2 subdomains</li>
                                          </ul>
                                          
                                      </div>
                                  </div>
                              </div>

                                <!--/ basic plan -->

                                <!-- standard plan -->
                                <div class="col-12 col-md-4">
                                  <div class="card standard-pricing text-center custom-card-dark">
                                      <input type="radio" name="selected_plan" value="standard" class="plan-radio" {% if data.subscription == 'standard' %}checked {% endif %} />
                                        <div class="card-body">
                                            <div class="pricing-badge text-right">
                                                {% comment %} <div class="badge badge-pill badge-light-primary">Popular</div> {% endcomment %}
                                            </div>
                                            {% comment %} <img src="../../../app-assets/images/illustration/Pot2.svg" class="mb-1" alt="svg img" /> {% endcomment %}
                                            <h3>Standard</h3>
                                            <p class="card-text">For small to medium businesses</p>
                                            <div class="annual-plan">
                                                <div class="plan-price mt-2">
                                                    <sup class="font-medium-1 font-weight-bold text-primary">$</sup>
                                                    <span class="pricing-standard-value font-weight-bolder text-primary">49</span>
                                                    <sub class="pricing-duration text-body font-medium-1 font-weight-bold">/month</sub>
                                                </div>
                                                <small class="annual-pricing d-none text-muted"></small>
                                            </div>
                                            <ul class="list-group list-group-circle text-left">
                                                <li class="list-group-item">Unlimited responses</li>
                                                <li class="list-group-item">Unlimited forms and surveys</li>
                                                <li class="list-group-item">Instagram profile page</li>
                                                <li class="list-group-item">Google Docs integration</li>
                                                <li class="list-group-item">Custom “Thank you” page</li>
                                            </ul>
                                           
                                        </div>
                                    </div>
                                </div>
                                <!--/ standard plan -->

                                <!-- enterprise plan -->
                                <div class="col-12 col-md-4">
                                  <div class="card enterprise-pricing text-center custom-card-dark">
                                      <input type="radio" name="selected_plan" value="enterprise" class="plan-radio" {% if data.subscription == 'enterprise' %}checked {% endif %} />
                                        <div class="card-body">
                                            {% comment %} <img src="../../../app-assets/images/illustration/Pot3.svg" class="mb-2" alt="svg img" /> {% endcomment %}
                                            <h3>Enterprise</h3>
                                            <p class="card-text">Solution for big organizations</p>
                                            <div class="annual-plan">
                                                <div class="plan-price mt-2">
                                                    <sup class="font-medium-1 font-weight-bold text-primary">$</sup>
                                                    <span class="pricing-enterprise-value font-weight-bolder text-primary">99</span>
                                                    <sub class="pricing-duration text-body font-medium-1 font-weight-bold">/month</sub>
                                                </div>
                                                <small class="annual-pricing d-none text-muted"></small>
                                            </div>
                                            <ul class="list-group list-group-circle text-left">
                                                <li class="list-group-item">PayPal payments</li>
                                                <li class="list-group-item">Logic Jumps</li>
                                                <li class="list-group-item">File upload with 5GB storage</li>
                                                <li class="list-group-item">Custom domain support</li>
                                                <li class="list-group-item">Stripe integration</li>
                                            </ul>
                                            
                                        </div>
                                    </div>
                                </div>
                                
                                <!--/ enterprise plan -->
                            </div>
                        </div>
                    </div>
                    <!--/ pricing plan cards -->

          
        </form >
        <div class="d-flex justify-content-between">
          <button class="btn btn-primary btn-prev" onclick="stepper.previous()">
            <i data-feather="arrow-left" class="align-middle mr-sm-25 mr-0"></i>
            <span class="align-middle d-sm-inline-block d-none">Previous</span>
          </button>
          <button class="btn btn-primary btn-next" onclick="submitForm(4)">
            <span class="align-middle d-sm-inline-block d-none">Next</span>
            <i data-feather="arrow-right" class="align-middle ml-sm-25 ml-0"></i>
          </button>
        </div>
      </div>
      <div id="review-offer" class="content">
   
        <form method="post" id="form-step-5" enctype="multipart/form-data">
          {% csrf_token %}
    
         
          <div class="row mb-2">
            <h6>Please contact us on help@misuhousing.com to make the payment and receive the payment code to activate the plan. </h6>
            <div class="col-md-3">
              <div class="form-group">
                  <label for="Property ">Payment code</label>
                  <input type="text" name="payment_code" id="payment_code" class="form-control">  
              </div>
              <div id="form-errors-5" style="color: red; margin-top: 10px;"></div>
            </div>
          </div>
            
        </form >
        <div class="d-flex justify-content-between">
          <button class="btn btn-primary btn-prev" onclick="stepper.previous()">
            <i data-feather="arrow-left" class="align-middle mr-sm-25 mr-0"></i>
            <span class="align-middle d-sm-inline-block d-none">Previous</span>
          </button>
          <button class="btn btn-primary btn-next" onclick="submitForm(5)">
            <span class="align-middle d-sm-inline-block d-none">Next</span>
            <i data-feather="arrow-right" class="align-middle ml-sm-25 ml-0"></i>
          </button>
          {% comment %} <button type="button" onclick='funsubmit()' id="sub001" class="btn btn-success" >Submit</button> {% endcomment %}
        </div>
      </div>
       <div id="step-6" class="content">
        <h6>Your selected plan is now activated on the account! Please click on Finish to close the Onboarding wizard. 

You will be redirected to Dashboard and other menu. Head to Listings to create your first Rental space. </h6>
          <div class="d-flex justify-content-between">
            <button type="button" onclick="reloadPage()" id="sub001" class="btn btn-success" >Finish</button>
          </div>
       </div>
  
    </div>
  </div>
</section>
            </div>
        </div>
        
        
    <!-- END: Content-->
{% endblock content %}

 {% block scriptjs %}
        
       <!-- BEGIN: Page Vendor JS-->
       <script href="{% static 'app-assets/vendors/js/forms/select/select2.full.min.js' %}"></script>
       <script href="{% static 'app-assets/vendors/js/forms/validation/jquery.validate.min.js' %}"></script>
       <script href="{% static 'app-assets/vendors/js/pickers/flatpickr/flatpickr.min.js' %}"></script>
       <!-- END: Page Vendor JS-->
        <script src="{% static 'app-assets/vendors/js/forms/wizard/bs-stepper.min.js' %}"></script>
        <script src="{% static 'app-assets/vendors/js/forms/select/select2.full.min.js' %}"></script>
        <script src="{% static 'app-assets/vendors/js/forms/validation/jquery.validate.min.js' %}"></script>
          <script src="{% static 'app-assets/vendors/js/forms/repeater/jquery.repeater.min.js' %}"></script>

       <!-- BEGIN: Page JS-->
       <script href="{% static 'app-assets/js/scripts/pages/app-user-edit.js' %}"></script>
       <script href="{% static 'app-assets/js/scripts/components/components-navs.js' %}"></script>
       {% comment %} <script src="{% static 'app-assets/js/scripts/forms/form-wizard.min.js' %}"></script> {% endcomment %}
        <script src="{% static 'app-assets/js/scripts/forms/form-repeater.min.js' %}"></script>
         <script src="{% static 'app-assets/js/scripts/customizer.min.js' %}"></script>
          <script src="{% static 'app-assets/js/scripts/pages/page-pricing.js' %}"></script>
         <script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js"></script>
<script>
  function validateFormStep(step) {
  const form = document.getElementById(`form-step-${step}`);
  let isValid = true;

  // Bootstrap validation
  if (!form.checkValidity()) {
    form.classList.add('was-validated');
    isValid = false;
  }

  // Custom radio button validation (since browser won't highlight group properly)
  const radios = form.querySelectorAll('input[name="subscription"]');
  const isRadioSelected = Array.from(radios).some(radio => radio.checked);


  return isValid;
}
function reloadPage() {
    window.location.href = '{% url "landload:home" %}';
  }
  select = $('.select2')
  select.each(function () {
    var $this = $(this);
    $this.wrap('<div class="position-relative"></div>');
    $this.select2({
      placeholder: 'Select value',
      dropdownParent: $this.parent()
    });
  });
$('#id_country').change(function() {
    var selectedCountry = $(this).val();
    console.log('run')
    if (selectedCountry) {
        $.ajax({
            url: '{% url "landload:locationdetails" %}',
            data: {
                'country': selectedCountry
            },
            success: function(data) {
                $('#id_currency').val(data.currency || '');
                const tzSelect = $('#id_time_zone');
    tzSelect.empty();

    // Add default option
    tzSelect.append('<option value="">Select Timezone</option>');

    // Populate with timezones
    data.timezone.forEach(function(tz) {
        tzSelect.append($('<option>', {
            value: tz[0],
            text: tz[1]
        }));
    });
            },
            error: function() {
                alert('Error fetching location details');
            }
        });
    }
});

  let currentCarouselId=''
function showCarouselModal(images, startIndex,carouselId) {
  currentCarouselId = carouselId

  console.log('cur',currentCarouselId)
  const carouselInner = document.querySelector('#carouselModalInner .carousel-inner');
  carouselInner.innerHTML = '';  // Clear previous content

  images.forEach((imgObj, i) => {
    const item = document.createElement('div');
    item.classList.add('carousel-item');
    if (i === startIndex) item.classList.add('active');

    const imageUrl = `/media/${imgObj.image}`;
    const imageId = imgObj.id;

    item.innerHTML = `
      <div class="position-relative">
        <img src="${imageUrl}" class="d-block w-100" alt="Slide ${i+1}">
        <div style="position: absolute; top: 15px; right: 15px; z-index: 10; display: flex; gap: 8px;">
          <a href="${imageUrl}" download class="btn btn-sm btn-primary"><i class="bi bi-download"></i> Download</a>
          <button class="btn btn-sm btn-danger" onclick="deleteModalImage(${imageId},${currentCarouselId})"><i class="bi bi-trash"></i> Delete</button>
        </div>
      </div>
    `;

    carouselInner.appendChild(item);
  });

  const modal = new bootstrap.Modal(document.getElementById('carouselModal'));
  modal.show();
}
</script>
         
<script>
   $(document).ready(function () {
    $('#customCheck001').on('change', function () {
    if ($(this).is(':checked')) {
      $('#repeater-section').find('input[type="text"], input[type="number"]').attr('required', true);
      $('#repeater-section').slideDown();
    } else {
      $('#repeater-section').find('input[type="text"], input[type="number"]').removeAttr('required');
      $('#repeater-section').slideUp();
    }
  });
});

const stepperElement = document.querySelector('.bs-stepper');
const stepper = new window.Stepper(stepperElement);
function showFormErrors(step, errors) {
    const errorDiv = document.getElementById(`form-errors-${step}`);
    if (!errorDiv) return;
    errorDiv.innerHTML = `<p>${errors}</p>`;
}



function submitForm(step) {
    const form = document.getElementById(`form-step-${step}`);
    if (!validateFormStep(step)) {
    return;
  }
    const formData = new FormData(form);

    fetch(`/landlord/onboad-step/${step}/`, {
        method: 'POST',
        headers: {
            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
        },
        body: formData
    })
    .then(async (response) => {
        const data = await response.json();
        console.log('Server response:', data);

        if (!response.ok || data.success === false) {
            showFormErrors(step, data.errors || 'Something went wrong. Please try again.');
            return; // ⛔ prevent step change
        }

        // Save formid to hidden fields if needed
        if (step === "2") {
            document.querySelector('#form-step-2 input[name="formid"]').value = data.formid;
        }
        if (step === "3") {
            document.querySelector('#form-step-3 input[name="formid2"]').value = data.formid;
        }

        // ✅ Move to next step using Stepper API
        stepper.next();
    })
    .catch((error) => {
        console.error('Unexpected error:', error);
        showFormErrors(step, 'Network error. Please try again.');
    });
}


</script>
{% endblock scriptjs %}